<!DOCTYPE html>
<html>
<head>
    <%- include ../common/head.ejs %>
    <style>
        strong.warning{
            display: block;
            font-size: 0.8em;
            color: red;
        }
    </style>
</head>
<body>
    <h1>회원가입 입니다</h1>

    <form action="" method="POST" id="signupForm">
        <p>
            id : <input type="text" name="id">
            <strong class="warning"></strong>
        </p>
        <p>
            pw : <input type="password" name="pw">
            <strong class="warning"></strong>
        </p>
        <p>
            이름 : <input type="text" name="name">
            <strong class="warning"></strong>
        </p>
        <p>
            나이 : <input type="number" name="age">
            <strong class="warning"></strong>
        </p>
        <p>
            성별<br>
            남 : <input type="radio" name="gender" value="M">
            여 : <input type="radio" name="gender" value="F">
            <strong class="warning"></strong>
        </p>
        <p>
            <button type="submit">회원가입</button>
        </p>
    </form>

    <h3>메뉴</h3>
    <ul>
        <li><a href="/">홈</a></li>
        <li><a href="/user/login">로그인</a></li>
    </ul>

    <script>

        // 포문으로 다른 항목도
        $('#signupForm').on('keyup', function(){
            return valids
            })

        function valids(){
            var rule = [
                {
                    name : 'id',
                    input : '#signupForm input[name=id]',
                    Pattern : /^([0-9a-zA-Z_]){2,8}$/,
                    message : '아이디 형식을 확인하세요.'
                },
                {
                    name : 'pw',
                    val : '#signupForm input[name=pw]',
                    Pattern : /^([0-9a-zA-Z_]){2,8}$/,
                    message : '패스워드 형식을 확인하세요.'
                },
                {
                    name : 'name',
                    val : '#signupForm input[name=name]',
                    Pattern : /^([가-힣a-zA-Z]){1,20}$/,
                    message : '이름 형식을 확인하세요.'
                },
                {
                    name : 'age',
                    val : '#signupForm input[name=age]',
                    Pattern : /^([0-9]){1,}$/,
                    message : '나이 형식을 확인하세요.'
                },
                {
                    name : 'gender',
                    val : '#signupForm input[name=gender]:checked',
                    Pattern : null,
                    message : '성별을 선택하세요.'
                }
            ]
            
            for(var ele of rule){
                $(ele.val).on('keyup', function(){
                    var id = $(this).val();
                    var idPattern = ele.Pattern;
                    if(!id || !idPattern.test(id)){
                        $(this).next().text(ele.message)
                        return false
                    }else{
                        $(this).next().html('')
                    }
                })    
            }
            return true
        }






        $('#signupForm').on('submit', function(){
            return valid()
        })

        function valid(){
            var rule = [
                {
                    name : 'id',
                    val : $('#signupForm input[name=id]').val(),
                    Pattern : /^([0-9a-zA-Z_]){2,8}$/,
                    message : '아이디 형식을 확인하세요.'
                },
                {
                    name : 'pw',
                    val : $('#signupForm input[name=pw]').val(),
                    Pattern : /^([0-9a-zA-Z_]){2,8}$/,
                    message : '패스워드 형식을 확인하세요.'
                },
                {
                    name : 'name',
                    val : $('#signupForm input[name=name]').val(),
                    Pattern : /^([가-힣a-zA-Z]){1,20}$/,
                    message : '이름 형식을 확인하세요.'
                },
                {
                    name : 'age',
                    val : parseInt($('#signupForm input[name=age]').val()),
                    Pattern : /^([0-9]){1,}$/,
                    message : '나이 형식을 확인하세요.'
                },
                {
                    name : 'gender',
                    val : $("#signupForm input[name=gender]:checked").val(),
                    Pattern : null,
                    message : '성별을 선택하세요.'
                }
            ]

            for(var ele of rule){
                if(!ele.val || !ele.Pattern.test(ele.val)){
                    alert(ele.message)
                    return false
                }
            }
            return true
        }
    </script>
</body>
</html>